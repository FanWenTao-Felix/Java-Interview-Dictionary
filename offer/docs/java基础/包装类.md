## 1.为什么需要包装类

为了让基本类型也具有对象的特征，就出现了包装类型，具有了对象的性质，并且为其添加了属性和方法，丰富了基本类型的操作。

## 2.自动装箱与自动拆箱的实现原理

自动装箱: 就是将基本数据类型自动转换成对应的包装类。

自动拆箱：就是将包装类自动转换成对应的基本数据类型。

有以下规律：

> 自动装箱都是通过包装类的 `valueOf()` 方法来实现的.自动拆箱都是通过包装类对象的 `xxxValue()` 来实现的。

## 3.哪些地方会自动拆装箱

场景一、将基本数据类型放入集合类
当我们把基本数据类型放入集合类中的时候，会进行自动装箱。
场景二、包装类型和基本类型的大小比较
包装类与基本数据类型进行比较运算，是先将包装类进行拆箱成基本数据类型，然后进行比较的。
场景三、包装类型的运算
两个包装类型之间的运算，会被自动拆箱成基本类型进行。
场景四、三目运算符的使用
当第二，第三位操作数分别为基本类型和对象时，其中的对象就会拆箱为基本类型进行操作。
场景五、函数参数与返回值

## 4.Java中Integer的缓存

在 Java 5 中，在 Integer 的操作上引入了一个新功能来节省内存和提高性能。整型对象通过使用相同的对象引用实现了缓存和重用。

> 适用于整数值区间 -128 至 +127。
>
> 只适用于自动装箱。使用构造函数创建对象不适用。

### Integer的缓存实现

Java的编译器把基本数据类型自动转换成封装类对象的过程叫做`自动装箱`，相当于使用`valueOf`方法。

在创建对象之前先从IntegerCache.cache中寻找。如果没找到才使用new新建对象。

#### IntegerCache Class

IntegerCache是Integer类中定义的一个`private static`的内部类。

缓存支持-128到127之间的自动装箱过程。最大值127可以通过`-XX:AutoBoxCacheMax=size`修改。 缓存通过一个for循环实现。从低到

高并创建尽可能多的整数并存储在一个整数数组中。这个缓存会在Integer类第一次被使用的时候被初始化出来。以后，就可以使用缓存

中包含的实例对象，而不是创建一个新的实例(在自动装箱的情况下)。

实际上这个功能在Java 5中引入的时候,范围是固定的-128 至 +127。后来在Java 6中，可以通过

`java.lang.Integer.IntegerCache.high`设置最大值。这使我们可以根据应用程序的实际情况灵活地调整来提高性能。到底是什么

原因选择这个-128到127范围呢？因为这个范围的数字是最被广泛使用的。 在程序中，第一次使用Integer的时候也需要一定的额外时间

来初始化这个缓存。

### Java语言规范中的缓存行为

如果一个变量p的值是：

-128至127之间的整数

true 和 false的布尔值 

‘\u0000’至 ‘\u007f’之间的字符

中时，将p包装成a和b两个对象时，可以直接使用a==b判断a和b的值是否相等。

### 其他缓存的对象

这种缓存行为不仅适用于Integer对象。我们针对所有的整数类型的类都有类似的缓存机制。

> 有ByteCache用于缓存Byte对象
>
> 有ShortCache用于缓存Short对象
>
> 有LongCache用于缓存Long对象
>
> 有CharacterCache用于缓存Character对象

`Byte`, `Short`, `Long`有固定范围: -128 到 127。对于`Character`, 范围是 0 到 127。除了`Integer`以外，这个范围都不能改变。

